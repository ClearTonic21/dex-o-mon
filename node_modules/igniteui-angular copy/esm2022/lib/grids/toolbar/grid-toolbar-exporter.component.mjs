import { Component, ContentChild, Input, Output, EventEmitter, Inject } from '@angular/core';
import { first } from 'rxjs/operators';
import { BaseToolbarDirective } from './grid-toolbar.base';
import { IgxExcelTextDirective, IgxCSVTextDirective } from './common';
import { CsvFileTypes, IgxCsvExporterOptions, IgxExcelExporterOptions } from '../../services/public_api';
import { IgxToggleDirective } from '../../directives/toggle/toggle.directive';
import { IgxToolbarToken } from './token';
import { NgIf, NgTemplateOutlet } from '@angular/common';
import { IgxIconComponent } from '../../icon/icon.component';
import { IgxRippleDirective } from '../../directives/ripple/ripple.directive';
import { IgxButtonDirective } from '../../directives/button/button.directive';
import * as i0 from "@angular/core";
import * as i1 from "../../services/public_api";
import * as i2 from "./token";
/**
 * Provides a pre-configured exporter component for the grid.
 *
 * @remarks
 * This component still needs the actual exporter service(s) provided in the DI chain
 * in order to export something.
 *
 * @igxModule IgxGridToolbarModule
 * @igxParent IgxGridToolbarComponent
 *
 */
export class IgxGridToolbarExporterComponent extends BaseToolbarDirective {
    constructor(toolbar, excelExporter, csvExporter) {
        super(toolbar);
        this.excelExporter = excelExporter;
        this.csvExporter = csvExporter;
        /**
         * Show entry for CSV export.
         */
        this.exportCSV = true;
        /**
         * Show entry for Excel export.
         */
        this.exportExcel = true;
        /**
         * The name for the exported file.
         */
        this.filename = 'ExportedData';
        /**
         * Emitted when starting an export operation. Re-emitted additionally
         * by the grid itself.
         */
        this.exportStarted = new EventEmitter();
        /**
         * Emitted on successful ending of an export operation.
         */
        this.exportEnded = new EventEmitter();
        /**
         * Indicates whether there is an export in progress.
         */
        this.isExporting = false;
    }
    export(type, toggleRef) {
        let options;
        let exporter;
        toggleRef?.close();
        switch (type) {
            case 'csv':
                options = new IgxCsvExporterOptions(this.filename, CsvFileTypes.CSV);
                exporter = this.csvExporter;
                break;
            case 'excel':
                options = new IgxExcelExporterOptions(this.filename);
                exporter = this.excelExporter;
        }
        const args = { exporter, options, grid: this.grid, cancel: false };
        this.exportStarted.emit(args);
        this.grid.toolbarExporting.emit(args);
        this.isExporting = true;
        this.toolbar.showProgress = true;
        if (args.cancel) {
            return;
        }
        exporter.exportEnded.pipe(first()).subscribe(() => {
            this.exportEnded.emit();
            this.isExporting = false;
            this.toolbar.showProgress = false;
        });
        exporter.export(this.grid, options);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.1.2", ngImport: i0, type: IgxGridToolbarExporterComponent, deps: [{ token: IgxToolbarToken }, { token: i1.IgxExcelExporterService }, { token: i1.IgxCsvExporterService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.1.2", type: IgxGridToolbarExporterComponent, isStandalone: true, selector: "igx-grid-toolbar-exporter", inputs: { exportCSV: "exportCSV", exportExcel: "exportExcel", filename: "filename" }, outputs: { exportStarted: "exportStarted", exportEnded: "exportEnded" }, queries: [{ propertyName: "hasExcelAttr", first: true, predicate: IgxExcelTextDirective, descendants: true }, { propertyName: "hasCSVAttr", first: true, predicate: IgxCSVTextDirective, descendants: true }], usesInheritance: true, ngImport: i0, template: "<button [title]=\"grid?.resourceStrings.igx_grid_toolbar_exporter_button_tooltip\" [disabled]=\"isExporting\"\r\n    igxButton=\"outlined\" type=\"button\" [displayDensity]=\"grid.displayDensity\" igxRipple #btn (click)=\"toggle(btn, toggleRef)\">\r\n\r\n    <igx-icon>import_export</igx-icon>\r\n    <span #ref>\r\n        <ng-content></ng-content>\r\n    </span>\r\n    <span *ngIf=\"!ref.childNodes.length\">\r\n        {{ grid?.resourceStrings.igx_grid_toolbar_exporter_button_label }}\r\n    </span>\r\n    <igx-icon>arrow_drop_down</igx-icon>\r\n</button>\r\n\r\n<div class=\"igx-grid-toolbar__dropdown\" id=\"btnExport\">\r\n    <ul class=\"igx-grid-toolbar__dd-list\" igxToggle #toggleRef=\"toggle\">\r\n        <li *ngIf=\"exportExcel\" #btnExportExcel id=\"btnExportExcel\"\r\n            class=\"igx-grid-toolbar__dd-list-items\" igxRipple (click)=\"export('excel', toggleRef)\">\r\n            <ng-template #excel>\r\n                <ng-content select=[excelText],excel-text></ng-content>\r\n            </ng-template>\r\n            <excel-text *ngIf=\"!hasExcelAttr\">\r\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_excel_entry_text}}\r\n            </excel-text>\r\n            <ng-container *ngTemplateOutlet=\"excel\"></ng-container>\r\n        </li>\r\n\r\n        <li *ngIf=\"exportCSV\" #btnExportCsv id=\"btnExportCsv\" class=\"igx-grid-toolbar__dd-list-items\"\r\n            igxRipple (click)=\"export('csv', toggleRef)\">\r\n            <ng-template #csv>\r\n                <ng-content select=[csvText],csv-text></ng-content>\r\n            </ng-template>\r\n            <csv-text *ngIf=\"!hasCSVAttr\">\r\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_csv_entry_text }}</csv-text>\r\n            <ng-container *ngTemplateOutlet=\"csv\"></ng-container>\r\n        </li>\r\n    </ul>\r\n</div>\r\n", dependencies: [{ kind: "directive", type: IgxButtonDirective, selector: "[igxButton]", inputs: ["selected", "igxButton", "igxButtonColor", "igxButtonBackground", "igxLabel", "disabled"], outputs: ["buttonClick", "buttonSelected"] }, { kind: "directive", type: IgxRippleDirective, selector: "[igxRipple]", inputs: ["igxRippleTarget", "igxRipple", "igxRippleDuration", "igxRippleCentered", "igxRippleDisabled"] }, { kind: "component", type: IgxIconComponent, selector: "igx-icon", inputs: ["family", "active", "name"] }, { kind: "directive", type: NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: IgxToggleDirective, selector: "[igxToggle]", inputs: ["id"], outputs: ["opened", "opening", "closed", "closing", "appended"], exportAs: ["toggle"] }, { kind: "directive", type: IgxExcelTextDirective, selector: "[excelText],excel-text" }, { kind: "directive", type: NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "directive", type: IgxCSVTextDirective, selector: "[csvText],csv-text" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.1.2", ngImport: i0, type: IgxGridToolbarExporterComponent, decorators: [{
            type: Component,
            args: [{ selector: 'igx-grid-toolbar-exporter', standalone: true, imports: [IgxButtonDirective, IgxRippleDirective, IgxIconComponent, NgIf, IgxToggleDirective, IgxExcelTextDirective, NgTemplateOutlet, IgxCSVTextDirective], template: "<button [title]=\"grid?.resourceStrings.igx_grid_toolbar_exporter_button_tooltip\" [disabled]=\"isExporting\"\r\n    igxButton=\"outlined\" type=\"button\" [displayDensity]=\"grid.displayDensity\" igxRipple #btn (click)=\"toggle(btn, toggleRef)\">\r\n\r\n    <igx-icon>import_export</igx-icon>\r\n    <span #ref>\r\n        <ng-content></ng-content>\r\n    </span>\r\n    <span *ngIf=\"!ref.childNodes.length\">\r\n        {{ grid?.resourceStrings.igx_grid_toolbar_exporter_button_label }}\r\n    </span>\r\n    <igx-icon>arrow_drop_down</igx-icon>\r\n</button>\r\n\r\n<div class=\"igx-grid-toolbar__dropdown\" id=\"btnExport\">\r\n    <ul class=\"igx-grid-toolbar__dd-list\" igxToggle #toggleRef=\"toggle\">\r\n        <li *ngIf=\"exportExcel\" #btnExportExcel id=\"btnExportExcel\"\r\n            class=\"igx-grid-toolbar__dd-list-items\" igxRipple (click)=\"export('excel', toggleRef)\">\r\n            <ng-template #excel>\r\n                <ng-content select=[excelText],excel-text></ng-content>\r\n            </ng-template>\r\n            <excel-text *ngIf=\"!hasExcelAttr\">\r\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_excel_entry_text}}\r\n            </excel-text>\r\n            <ng-container *ngTemplateOutlet=\"excel\"></ng-container>\r\n        </li>\r\n\r\n        <li *ngIf=\"exportCSV\" #btnExportCsv id=\"btnExportCsv\" class=\"igx-grid-toolbar__dd-list-items\"\r\n            igxRipple (click)=\"export('csv', toggleRef)\">\r\n            <ng-template #csv>\r\n                <ng-content select=[csvText],csv-text></ng-content>\r\n            </ng-template>\r\n            <csv-text *ngIf=\"!hasCSVAttr\">\r\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_csv_entry_text }}</csv-text>\r\n            <ng-container *ngTemplateOutlet=\"csv\"></ng-container>\r\n        </li>\r\n    </ul>\r\n</div>\r\n" }]
        }], ctorParameters: function () { return [{ type: i2.IgxToolbarToken, decorators: [{
                    type: Inject,
                    args: [IgxToolbarToken]
                }] }, { type: i1.IgxExcelExporterService }, { type: i1.IgxCsvExporterService }]; }, propDecorators: { hasExcelAttr: [{
                type: ContentChild,
                args: [IgxExcelTextDirective]
            }], hasCSVAttr: [{
                type: ContentChild,
                args: [IgxCSVTextDirective]
            }], exportCSV: [{
                type: Input
            }], exportExcel: [{
                type: Input
            }], filename: [{
                type: Input
            }], exportStarted: [{
                type: Output
            }], exportEnded: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZC10b29sYmFyLWV4cG9ydGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lnbml0ZXVpLWFuZ3VsYXIvc3JjL2xpYi9ncmlkcy90b29sYmFyL2dyaWQtdG9vbGJhci1leHBvcnRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZ25pdGV1aS1hbmd1bGFyL3NyYy9saWIvZ3JpZHMvdG9vbGJhci9ncmlkLXRvb2xiYXItZXhwb3J0ZXIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzdGLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN2QyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMzRCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDdEUsT0FBTyxFQUNILFlBQVksRUFFWixxQkFBcUIsRUFFckIsdUJBQXVCLEVBRTFCLE1BQU0sMkJBQTJCLENBQUM7QUFDbkMsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFFOUUsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUMxQyxPQUFPLEVBQUUsSUFBSSxFQUFFLGdCQUFnQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDN0QsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFDOUUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sMENBQTBDLENBQUM7Ozs7QUFh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Qzs7MEJBdUR0SixNQUFNOzJCQUFDLGVBQWU7c0hBOUNwQixZQUFZO3NCQURsQixZQUFZO3VCQUFDLHFCQUFxQjtnQkFRNUIsVUFBVTtzQkFEaEIsWUFBWTt1QkFBQyxtQkFBbUI7Z0JBTzFCLFNBQVM7c0JBRGYsS0FBSztnQkFPQyxXQUFXO3NCQURqQixLQUFLO2dCQU9DLFFBQVE7c0JBRGQsS0FBSztnQkFRQyxhQUFhO3NCQURuQixNQUFNO2dCQU9BLFdBQVc7c0JBRGpCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIENvbnRlbnRDaGlsZCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGZpcnN0IH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQmFzZVRvb2xiYXJEaXJlY3RpdmUgfSBmcm9tICcuL2dyaWQtdG9vbGJhci5iYXNlJztcbmltcG9ydCB7IElneEV4Y2VsVGV4dERpcmVjdGl2ZSwgSWd4Q1NWVGV4dERpcmVjdGl2ZSB9IGZyb20gJy4vY29tbW9uJztcbmltcG9ydCB7XG4gICAgQ3N2RmlsZVR5cGVzLFxuICAgIElneEJhc2VFeHBvcnRlcixcbiAgICBJZ3hDc3ZFeHBvcnRlck9wdGlvbnMsXG4gICAgSWd4Q3N2RXhwb3J0ZXJTZXJ2aWNlLFxuICAgIElneEV4Y2VsRXhwb3J0ZXJPcHRpb25zLFxuICAgIElneEV4Y2VsRXhwb3J0ZXJTZXJ2aWNlXG59IGZyb20gJy4uLy4uL3NlcnZpY2VzL3B1YmxpY19hcGknO1xuaW1wb3J0IHsgSWd4VG9nZ2xlRGlyZWN0aXZlIH0gZnJvbSAnLi4vLi4vZGlyZWN0aXZlcy90b2dnbGUvdG9nZ2xlLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBHcmlkVHlwZSB9IGZyb20gJy4uL2NvbW1vbi9ncmlkLmludGVyZmFjZSc7XG5pbXBvcnQgeyBJZ3hUb29sYmFyVG9rZW4gfSBmcm9tICcuL3Rva2VuJztcbmltcG9ydCB7IE5nSWYsIE5nVGVtcGxhdGVPdXRsZXQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgSWd4SWNvbkNvbXBvbmVudCB9IGZyb20gJy4uLy4uL2ljb24vaWNvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgSWd4UmlwcGxlRGlyZWN0aXZlIH0gZnJvbSAnLi4vLi4vZGlyZWN0aXZlcy9yaXBwbGUvcmlwcGxlLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBJZ3hCdXR0b25EaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2J1dHRvbi9idXR0b24uZGlyZWN0aXZlJztcblxuXG5leHBvcnQgdHlwZSBJZ3hFeHBvcnRlck9wdGlvbnMgPSBJZ3hDc3ZFeHBvcnRlck9wdGlvbnMgfCBJZ3hFeGNlbEV4cG9ydGVyT3B0aW9ucztcblxuXG5leHBvcnQgaW50ZXJmYWNlIElneEV4cG9ydGVyRXZlbnQge1xuICAgIGV4cG9ydGVyOiBJZ3hCYXNlRXhwb3J0ZXI7XG4gICAgb3B0aW9uczogSWd4RXhwb3J0ZXJPcHRpb25zO1xuICAgIGdyaWQ6IEdyaWRUeXBlO1xuICAgIGNhbmNlbDogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhIHByZS1jb25maWd1cmVkIGV4cG9ydGVyIGNvbXBvbmVudCBmb3IgdGhlIGdyaWQuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgY29tcG9uZW50IHN0aWxsIG5lZWRzIHRoZSBhY3R1YWwgZXhwb3J0ZXIgc2VydmljZShzKSBwcm92aWRlZCBpbiB0aGUgREkgY2hhaW5cbiAqIGluIG9yZGVyIHRvIGV4cG9ydCBzb21ldGhpbmcuXG4gKlxuICogQGlneE1vZHVsZSBJZ3hHcmlkVG9vbGJhck1vZHVsZVxuICogQGlneFBhcmVudCBJZ3hHcmlkVG9vbGJhckNvbXBvbmVudFxuICpcbiAqL1xuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdpZ3gtZ3JpZC10b29sYmFyLWV4cG9ydGVyJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vZ3JpZC10b29sYmFyLWV4cG9ydGVyLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdGFuZGFsb25lOiB0cnVlLFxuICAgIGltcG9ydHM6IFtJZ3hCdXR0b25EaXJlY3RpdmUsIElneFJpcHBsZURpcmVjdGl2ZSwgSWd4SWNvbkNvbXBvbmVudCwgTmdJZiwgSWd4VG9nZ2xlRGlyZWN0aXZlLCBJZ3hFeGNlbFRleHREaXJlY3RpdmUsIE5nVGVtcGxhdGVPdXRsZXQsIElneENTVlRleHREaXJlY3RpdmVdXG59KVxuZXhwb3J0IGNsYXNzIElneEdyaWRUb29sYmFyRXhwb3J0ZXJDb21wb25lbnQgZXh0ZW5kcyBCYXNlVG9vbGJhckRpcmVjdGl2ZSB7XG5cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgQENvbnRlbnRDaGlsZChJZ3hFeGNlbFRleHREaXJlY3RpdmUpXG4gICAgcHVibGljIGhhc0V4Y2VsQXR0cjogSWd4RXhjZWxUZXh0RGlyZWN0aXZlO1xuXG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIEBDb250ZW50Q2hpbGQoSWd4Q1NWVGV4dERpcmVjdGl2ZSlcbiAgICBwdWJsaWMgaGFzQ1NWQXR0cjogSWd4Q1NWVGV4dERpcmVjdGl2ZTtcblxuICAgIC8qKlxuICAgICAqIFNob3cgZW50cnkgZm9yIENTViBleHBvcnQuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZXhwb3J0Q1NWID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIFNob3cgZW50cnkgZm9yIEV4Y2VsIGV4cG9ydC5cbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBleHBvcnRFeGNlbCA9IHRydWU7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBmb3IgdGhlIGV4cG9ydGVkIGZpbGUuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZmlsZW5hbWUgPSAnRXhwb3J0ZWREYXRhJztcblxuICAgIC8qKlxuICAgICAqIEVtaXR0ZWQgd2hlbiBzdGFydGluZyBhbiBleHBvcnQgb3BlcmF0aW9uLiBSZS1lbWl0dGVkIGFkZGl0aW9uYWxseVxuICAgICAqIGJ5IHRoZSBncmlkIGl0c2VsZi5cbiAgICAgKi9cbiAgICBAT3V0cHV0KClcbiAgICBwdWJsaWMgZXhwb3J0U3RhcnRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8SWd4RXhwb3J0ZXJFdmVudD4oKTtcblxuICAgIC8qKlxuICAgICAqIEVtaXR0ZWQgb24gc3VjY2Vzc2Z1bCBlbmRpbmcgb2YgYW4gZXhwb3J0IG9wZXJhdGlvbi5cbiAgICAgKi9cbiAgICBAT3V0cHV0KClcbiAgICBwdWJsaWMgZXhwb3J0RW5kZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGVyZSBpcyBhbiBleHBvcnQgaW4gcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGlzRXhwb3J0aW5nID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgQEluamVjdChJZ3hUb29sYmFyVG9rZW4pIHRvb2xiYXI6IElneFRvb2xiYXJUb2tlbixcbiAgICAgICAgcHJpdmF0ZSBleGNlbEV4cG9ydGVyOiBJZ3hFeGNlbEV4cG9ydGVyU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBjc3ZFeHBvcnRlcjogSWd4Q3N2RXhwb3J0ZXJTZXJ2aWNlLFxuICAgICkge1xuICAgICAgICBzdXBlcih0b29sYmFyKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZXhwb3J0KHR5cGU6ICdleGNlbCcgfCAnY3N2JywgdG9nZ2xlUmVmPzogSWd4VG9nZ2xlRGlyZWN0aXZlKTogdm9pZCB7XG4gICAgICAgIGxldCBvcHRpb25zOiBJZ3hFeHBvcnRlck9wdGlvbnM7XG4gICAgICAgIGxldCBleHBvcnRlcjogSWd4QmFzZUV4cG9ydGVyO1xuXG4gICAgICAgIHRvZ2dsZVJlZj8uY2xvc2UoKTtcblxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ2Nzdic6XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IG5ldyBJZ3hDc3ZFeHBvcnRlck9wdGlvbnModGhpcy5maWxlbmFtZSwgQ3N2RmlsZVR5cGVzLkNTVik7XG4gICAgICAgICAgICAgICAgZXhwb3J0ZXIgPSB0aGlzLmNzdkV4cG9ydGVyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZXhjZWwnOlxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBuZXcgSWd4RXhjZWxFeHBvcnRlck9wdGlvbnModGhpcy5maWxlbmFtZSk7XG4gICAgICAgICAgICAgICAgZXhwb3J0ZXIgPSB0aGlzLmV4Y2VsRXhwb3J0ZXI7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhcmdzID0geyBleHBvcnRlciwgb3B0aW9ucywgZ3JpZDogdGhpcy5ncmlkLCBjYW5jZWw6IGZhbHNlIH0gYXMgSWd4RXhwb3J0ZXJFdmVudDtcblxuICAgICAgICB0aGlzLmV4cG9ydFN0YXJ0ZWQuZW1pdChhcmdzKTtcbiAgICAgICAgdGhpcy5ncmlkLnRvb2xiYXJFeHBvcnRpbmcuZW1pdChhcmdzKTtcbiAgICAgICAgdGhpcy5pc0V4cG9ydGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMudG9vbGJhci5zaG93UHJvZ3Jlc3MgPSB0cnVlO1xuXG4gICAgICAgIGlmIChhcmdzLmNhbmNlbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZXhwb3J0ZXIuZXhwb3J0RW5kZWQucGlwZShmaXJzdCgpKS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5leHBvcnRFbmRlZC5lbWl0KCk7XG4gICAgICAgICAgICB0aGlzLmlzRXhwb3J0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnRvb2xiYXIuc2hvd1Byb2dyZXNzID0gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGV4cG9ydGVyLmV4cG9ydCh0aGlzLmdyaWQsIG9wdGlvbnMpO1xuICAgIH1cbn1cbiIsIjxidXR0b24gW3RpdGxlXT1cImdyaWQ/LnJlc291cmNlU3RyaW5ncy5pZ3hfZ3JpZF90b29sYmFyX2V4cG9ydGVyX2J1dHRvbl90b29sdGlwXCIgW2Rpc2FibGVkXT1cImlzRXhwb3J0aW5nXCJcclxuICAgIGlneEJ1dHRvbj1cIm91dGxpbmVkXCIgdHlwZT1cImJ1dHRvblwiIFtkaXNwbGF5RGVuc2l0eV09XCJncmlkLmRpc3BsYXlEZW5zaXR5XCIgaWd4UmlwcGxlICNidG4gKGNsaWNrKT1cInRvZ2dsZShidG4sIHRvZ2dsZVJlZilcIj5cclxuXHJcbiAgICA8aWd4LWljb24+aW1wb3J0X2V4cG9ydDwvaWd4LWljb24+XHJcbiAgICA8c3BhbiAjcmVmPlxyXG4gICAgICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cclxuICAgIDwvc3Bhbj5cclxuICAgIDxzcGFuICpuZ0lmPVwiIXJlZi5jaGlsZE5vZGVzLmxlbmd0aFwiPlxyXG4gICAgICAgIHt7IGdyaWQ/LnJlc291cmNlU3RyaW5ncy5pZ3hfZ3JpZF90b29sYmFyX2V4cG9ydGVyX2J1dHRvbl9sYWJlbCB9fVxyXG4gICAgPC9zcGFuPlxyXG4gICAgPGlneC1pY29uPmFycm93X2Ryb3BfZG93bjwvaWd4LWljb24+XHJcbjwvYnV0dG9uPlxyXG5cclxuPGRpdiBjbGFzcz1cImlneC1ncmlkLXRvb2xiYXJfX2Ryb3Bkb3duXCIgaWQ9XCJidG5FeHBvcnRcIj5cclxuICAgIDx1bCBjbGFzcz1cImlneC1ncmlkLXRvb2xiYXJfX2RkLWxpc3RcIiBpZ3hUb2dnbGUgI3RvZ2dsZVJlZj1cInRvZ2dsZVwiPlxyXG4gICAgICAgIDxsaSAqbmdJZj1cImV4cG9ydEV4Y2VsXCIgI2J0bkV4cG9ydEV4Y2VsIGlkPVwiYnRuRXhwb3J0RXhjZWxcIlxyXG4gICAgICAgICAgICBjbGFzcz1cImlneC1ncmlkLXRvb2xiYXJfX2RkLWxpc3QtaXRlbXNcIiBpZ3hSaXBwbGUgKGNsaWNrKT1cImV4cG9ydCgnZXhjZWwnLCB0b2dnbGVSZWYpXCI+XHJcbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjZXhjZWw+XHJcbiAgICAgICAgICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9W2V4Y2VsVGV4dF0sZXhjZWwtdGV4dD48L25nLWNvbnRlbnQ+XHJcbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XHJcbiAgICAgICAgICAgIDxleGNlbC10ZXh0ICpuZ0lmPVwiIWhhc0V4Y2VsQXR0clwiPlxyXG4gICAgICAgICAgICAgICAge3sgZ3JpZD8ucmVzb3VyY2VTdHJpbmdzLmlneF9ncmlkX3Rvb2xiYXJfZXhwb3J0ZXJfZXhjZWxfZW50cnlfdGV4dH19XHJcbiAgICAgICAgICAgIDwvZXhjZWwtdGV4dD5cclxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImV4Y2VsXCI+PC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgPC9saT5cclxuXHJcbiAgICAgICAgPGxpICpuZ0lmPVwiZXhwb3J0Q1NWXCIgI2J0bkV4cG9ydENzdiBpZD1cImJ0bkV4cG9ydENzdlwiIGNsYXNzPVwiaWd4LWdyaWQtdG9vbGJhcl9fZGQtbGlzdC1pdGVtc1wiXHJcbiAgICAgICAgICAgIGlneFJpcHBsZSAoY2xpY2spPVwiZXhwb3J0KCdjc3YnLCB0b2dnbGVSZWYpXCI+XHJcbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjY3N2PlxyXG4gICAgICAgICAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVtjc3ZUZXh0XSxjc3YtdGV4dD48L25nLWNvbnRlbnQ+XHJcbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XHJcbiAgICAgICAgICAgIDxjc3YtdGV4dCAqbmdJZj1cIiFoYXNDU1ZBdHRyXCI+XHJcbiAgICAgICAgICAgICAgICB7eyBncmlkPy5yZXNvdXJjZVN0cmluZ3MuaWd4X2dyaWRfdG9vbGJhcl9leHBvcnRlcl9jc3ZfZW50cnlfdGV4dCB9fTwvY3N2LXRleHQ+XHJcbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJjc3ZcIj48L25nLWNvbnRhaW5lcj5cclxuICAgICAgICA8L2xpPlxyXG4gICAgPC91bD5cclxuPC9kaXY+XHJcbiJdfQ==