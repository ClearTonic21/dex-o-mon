<div class="entry-cards-list-container">
  <igx-list #cardListContainer>
  @for (card of entryCards; track $index) {
    <div class="card-container" [ngClass]="{'not-edit-mode' : !listEditMode}" igxDrop>
      <igx-list-item
        id="entry-card-{{card.guid}}"
        #dragDirRef="drag"
        igxDrop
        [igxDrag]="{ id: card.index, dragged: false }"
        (dragStart)="onDragStart($event, $index)"
        (dragMove)="onDragMove($event, $index)"
        (dragEnd)="onDragEnd($event, $index)"
        (transitioned)="onTransitioned($event, $index)"
        [ghost]="false"
        [class.dragged]="dragDirRef.data && dragDirRef.data.dragged"
        (click)="onClick($event, card)"
      >
        <div class="list-item-content">
          <entry-card
            [entryCard]="card"
            [entryEditMode]="listEditMode"
          ></entry-card>
        @if (listEditMode) {
          <div class="list-item-action" igxListAction>
            <igx-icon
              role="edit-icon"
              igxListAction
              family="material"
              (click)="onClick($event, card)"
            >edit</igx-icon>
            <igx-icon
              role="drag-icon"
              igxListAction
              igxDragHandle
              family="material"
            >drag_indicator</igx-icon>
          </div>
        }
        </div>
      </igx-list-item>
    </div>
  }
  @if (listEditMode) {
    <div class="card-container">
      <igx-list-item
        id="entry-card-add-button"
        class="new-item-button"
        (click)="addEntryCard()"
      >
        <igx-icon role="add-icon" family="material">add_circle</igx-icon>
      </igx-list-item>
    </div>
  }
    <ng-template igxEmptyList>
      <span class="emptyState">Switch to Edit mode: <igx-icon class="inline-icon" family="material">edit</igx-icon> to add entries.</span>
    </ng-template>
  </igx-list>
  <div>
    <igx-drop-down
      #actionDropdown
      (selectionChanging)='handleActionSelection($event)'
    >
      <div class="drop-down-virtual-wrapper">
        <igx-drop-down-item class="drop-down-title" [isHeader]="true">
          <div>{{entryCardClicked().title}}</div>
        </igx-drop-down-item>
        <igx-divider></igx-divider>
      @for (action of entryActions; track action) {
        <igx-drop-down-item [value]="action.value" [ngClass]="{'delete-action': action.isDelete}">
          <span class="action-drop-down-item" [ngClass]="{'delete-action': action.isDelete}">
            <igx-icon family="material">{{action.iconName}}</igx-icon>
            <span>{{action.label}}</span>
          </span>
        </igx-drop-down-item>
      }
      </div>
    </igx-drop-down>
  </div>
  <div>
    <igx-drop-down
      #entryCardTypeDropdown
      (selectionChanging)='switchEntryCardType()'
    >
      <div class="drop-down-virtual-wrapper">
        <igx-drop-down-item class="drop-down-title" [isHeader]="true">
          <div>Switch Entry Card Type</div>
        </igx-drop-down-item>
        <igx-divider></igx-divider>
      @for (type of entryCardTypes; track type) {
        <igx-drop-down-item
          [value]="type.toString()"
          [ngClass]="{'disabled': isDisabledEntryCardType(type)}"
        >
          <span class="card-type-drop-down-item">
            <igx-icon family="material">{{type}}</igx-icon>
            <span>{{type.toString()}}</span>
          </span>
        </igx-drop-down-item>
      }
      </div>
    </igx-drop-down>
  </div>
</div>